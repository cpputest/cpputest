language: cpp

dist: trusty
sudo: false

matrix:
    include:
    - compiler: clang
      env: BUILD=cmake CPP11=OFF
      addons:
        apt:
          packages:
            - libc++-dev
    - compiler: clang
      env: BUILD=cmake CPP11=ON
      addons:
        apt:
          packages:
            - libc++-dev

    - compiler: gcc
      env: BUILD=cmake CPP11=OFF
    - compiler: gcc
      env: BUILD=cmake CPP11=ON

    - compiler: gcc
      env: BUILD=autotools
      addons:
        apt:
          packages:
            - valgrind
    - compiler: clang
      env: BUILD=autotools
      addons:
        apt:
          packages:
            - libc++-dev
            - valgrind

    - compiler: gcc
      env: BUILD=cmake_coverage
    - compiler: gcc
      env: BUILD=cmake_gtest
    - compiler: wcl
      env: BUILD=make_dos
      addons:
        apt:
          packages:
            - dosbox

    - compiler: clang
      os: osx
      env: BUILD=cmake


before_script:
    - export CPPUTEST_BUILD_DIR=$TRAVIS_BUILD_DIR/cpputest_build
    - mkdir -p $CPPUTEST_BUILD_DIR && cd $CPPUTEST_BUILD_DIR
script:
    - "../scripts/travis_ci_build.sh"
after_failure:
    - "../scripts/travis_ci_after.sh"
after_success:
    - "../scripts/travis_ci_after.sh"
